import{r as m,j as e,c as y,B as S,u as C,F as $,a as E,b as P,d as I,e as M,W as D}from"./index-ce9bc285.js";import{P as L}from"./Pagination-5fbeb3ef.js";import{t as A,S as B}from"./SkeletonCard-46961359.js";import{u as F}from"./useQuery-085ac5f4.js";import{C as G}from"./Card-bc3e0ffa.js";import O from"./Error404Page-25dc6c53.js";import{E as R}from"./Error500Page-33d243bf.js";const j=({buttonIcon:t,title:r,renderItems:o,grid:d,dropContentClassName:a,selected:i="All"})=>{const[c,h]=m.useState(!1),f=m.useRef(null),x=m.useRef(null),l=()=>{h(s=>!s)};return m.useEffect(()=>{const s=_=>{f.current&&f.current.contains(_.target)||x.current&&x.current.contains(_.target)||h(!1)};return document.addEventListener("click",s),()=>{document.removeEventListener("click",s)}},[f,x]),e.jsxs("div",{className:"relative w-[48%] xs:w-auto",children:[e.jsxs("button",{ref:f,className:y(`flex items-center gap-1 whitespace-nowrap rounded bg-[#212529] px-4 py-2 text-xs 
                leading-normal text-[#4b5156] transition duration-150 ease-in-out 
                focus:outline-none focus:ring-0 active:bg-primary-700 
                capitalize
                font-normal hover:bg-[#2c3237]
                w-full
                justify-center
                xs:justify-start
                motion-reduce:transition-none`),type:"button",onClick:l,id:"dropdownMenuButton1","data-te-dropdown-toggle-ref":!0,"aria-expanded":"false","data-te-ripple-init":!0,"data-te-ripple-color":"light",children:[t,e.jsx("span",{children:r}),e.jsx("span",{className:"text-white/70",children:i})]}),e.jsx("div",{ref:x,"data-te-dropdown-show":!0,className:y(`absolute z-20 float-left m-0 hidden 
                list-none overflow-hidden rounded-[6px] border-none
                mt-1 bg-[#212529] p-3  
                 gap-x-1 dropdown-content
                 ${!d&&"h-80 overflow-y-auto scroll-bar"}
                 flex-wrap ${d?"w-[200%] sm:w-[400px] md:w-[600px] [&.active]:flex":"w-max [&.active]:block"}`,{active:c},a),"aria-labelledby":"dropdownMenuButton1","data-te-dropdown-menu-ref":!0,children:o()})]})},v=({id:t,name:r,value:o,check:d,onChangeEvent:a})=>{const i=c=>{a&&a(c.target.checked,o)};return e.jsxs("div",{className:"flex items-center w-[48%] sm:w-[32%] md:w-[24%]",children:[e.jsx("input",{type:"checkbox",id:`${t}`,onChange:i,className:"checkbox peer hidden",checked:d,value:o}),e.jsxs("label",{htmlFor:`${t}`,className:`flex h-8 gap-2 peer-checked:px-0 peer-checked:gap-0 px-2 w-full items-center text-white/60 text-xs hover:bg-[#16181b] \r
                            py-[2px] transition duration-300 rounded cursor-pointer\r
                            before:content-[""] before:w-3 before:h-3 before:bg-[#434b53]`,children:[e.jsx(S,{className:"text-dark-teal text-[28px] hidden icons"}),r]})]})},N=({id:t,name:r,value:o,check:d,fieldName:a,onChangeEvent:i})=>{const c=h=>{console.log(`checked::${h.target.checked}`),i&&i(h.target.checked,o)};return e.jsxs("div",{className:"flex items-center w-full xs:w-max",children:[e.jsx("input",{type:"radio",id:`${t}`,onChange:c,name:a||"check-radio",className:"checkbox peer hidden",checked:d,value:o}),e.jsxs("label",{htmlFor:`${t}`,className:`flex h-8 gap-2 peer-checked:px-2 peer-checked:gap-0 px-4 w-full items-center text-white/60 text-xs hover:bg-[#16181b] \r
                            py-[2px] transition duration-300 rounded cursor-pointer\r
                            before:content-[""] before:w-3 before:h-3 before:rounded-full before:bg-[#434b53]`,children:[e.jsx(S,{className:"text-dark-teal text-[28px] hidden icons"}),r]})]})},k=[{iso_639_1:"cn",english_name:"Chinese",name:"广州话 / 廣州話"},{iso_639_1:"en",english_name:"English",name:"English"},{iso_639_1:"fi",english_name:"Finnish",name:"suomi"},{iso_639_1:"de",english_name:"German",name:"Deutsch"},{iso_639_1:"hi",english_name:"Hindi",name:"हिन्दी"},{iso_639_1:"hu",english_name:"Hungarian",name:"Magyar"},{iso_639_1:"id",english_name:"Indonesian",name:"Bahasa indonesia"},{iso_639_1:"it",english_name:"Italian",name:"Italiano"},{iso_639_1:"ja",english_name:"Japanese",name:"日本語"},{iso_639_1:"ko",english_name:"Korean",name:"한국어/조선말"},{iso_639_1:"lo",english_name:"Lao",name:""},{iso_639_1:"la",english_name:"Latin",name:"Latin"},{iso_639_1:"ms",english_name:"Malay",name:"Bahasa melayu"},{iso_639_1:"zh",english_name:"Mandarin",name:"普通话"},{iso_639_1:"no",english_name:"Norwegian",name:"Norsk"},{iso_639_1:"pt",english_name:"Portuguese",name:"Português"},{iso_639_1:"ru",english_name:"Russian",name:"Pусский"},{iso_639_1:"ca",english_name:"Spanish",name:"Català"},{iso_639_1:"sv",english_name:"Swedish",name:"svenska"},{iso_639_1:"th",english_name:"Thai",name:"ภาษาไทย"},{iso_639_1:"tr",english_name:"Turkish",name:"Türkçe"},{iso_639_1:"uk",english_name:"Ukrainian",name:"Український"},{iso_639_1:"vi",english_name:"Vietnamese",name:"Tiếng Việt"}],Y=({media_type:t,onFilter:r})=>{const[o,d]=C(),[a,i]=m.useState({genres:[],languages:[],year:""}),c=F({queryKey:[`genres_${t}`],queryFn:()=>A.getGenres(`${t}`)});let h=m.useMemo(()=>{var n,p;return a.genres.length===0?"All":a.genres.length>1?`${a.genres.length} selected`:((p=(n=c.data)==null?void 0:n.data.genres.find(u=>u.id===+a.genres[0]))==null?void 0:p.name)||"All"},[a.genres,c]),f=m.useMemo(()=>{var n;return a.languages.length===0?"All":a.languages.length>1?`${a.languages.length} selected`:((n=k.find(p=>p.iso_639_1===a.languages[0]))==null?void 0:n.english_name)||"All"},[a]),x=m.useMemo(()=>a.year!==""?a.year:"All",[a.year]);m.useEffect(()=>{let n={genres:[],languages:[],year:""};n.genres=o.getAll("genres"),n.languages=o.getAll("languages"),n.year=o.get("year")||"",i(n)},[o]);const l=(n,p)=>{let u=a;n&&(u.year=p),i({...u})},s=n=>(p,u)=>{let g={...a};p?(g[n].push(u),i({...a})):(g[n].splice(g[n].indexOf(u),1),i({...a}))},_=()=>{if(c.data)return c.data.data.genres.map(n=>e.jsx(v,{name:n.name,value:n.id.toString(),check:a.genres.includes(n.id+""),onChangeEvent:s("genres"),id:`check-${n.name}`},n.id.toString()))},w=()=>{if(k)return k.map(n=>e.jsx(v,{name:n.english_name,value:n.iso_639_1,check:a.languages.includes(n.iso_639_1),id:`check-${n.english_name}`,onChangeEvent:s("languages")},n.english_name))},b=()=>{let n=[e.jsx(N,{name:"All",check:a.year==="",value:"",id:"check-all",onChangeEvent:l},"all")],u=new Date().getFullYear();for(let g=u;g>=u-12;g--)n.push(e.jsx(N,{name:g+"",check:a.year===g+"",value:g+"",id:`check-${g.toString()}`,onChangeEvent:l},g.toString()));return n};return e.jsxs("div",{className:"mt-6 flex items-center flex-wrap xs:flex-nowrap gap-2",children:[e.jsx(j,{grid:!0,selected:h,buttonIcon:e.jsx($,{className:"text-sm"}),title:"Genre",renderItems:_},1),e.jsx(j,{grid:!0,selected:f,dropContentClassName:"languages-drop",buttonIcon:e.jsx(E,{className:"text-sm"}),title:"Languages",renderItems:w},2),e.jsx(j,{selected:x,buttonIcon:e.jsx(P,{className:"text-sm"}),title:"Years",renderItems:b},3),e.jsxs("button",{onClick:()=>r&&r(a),className:" w-[48%] xs:w-auto px-2 py-1.5 hover:opacity-75 cursor-pointer transition-opacity duration-300 h-full font-light text-sm gap-x-1 flex justify-center items-center bg-dark-teal rounded",children:[e.jsx(I,{className:"text-base"}),"Filter"]})]})},W=({media_type:t})=>{var x;const[r,o]=C(),d=m.useMemo(()=>{let l=parseInt(r.get("page")||"1"),s=r.getAll("genres").join("|"),_=r.getAll("languages").join("|"),w=r.get("year"),b={page:l};return _&&(b.with_original_language=_),s&&(b.with_genres=s),w&&t==="movie"&&(b.primary_release_year=w),w&&t==="tv"&&(b.first_air_date_year=w),b},[r]),{data:a,error:i,isError:c,isLoading:h}=F({queryKey:[`latest_${t}`,d],queryFn:()=>A.getDiscoverList(t,d),keepPreviousData:!0,retry:2}),f=l=>{let s={};l.year!==""&&(s.year=l.year),s.genres=l.genres,s.languages=l.languages,o({...r,...s})};return c&&i?M.isAxiosError(i&&((x=i.response)==null?void 0:x.status)===404)?e.jsx(O,{}):e.jsx(R,{}):e.jsx("div",{className:"pt-20 pb-12 bg-black-2",children:e.jsx("section",{className:"top-rated py-6 bg-black-2",children:e.jsxs(D,{children:[e.jsx("h2",{className:'text-light-gray capitalize py-1 text-2xl relative after:content-[""] after:absolute after:bottom-0 after:left-0 after:w-16 after:h-[1px] after:bg-white/40',children:t==="movie"?"movie":"tv-series"}),e.jsx(Y,{media_type:t,onFilter:f}),e.jsxs("div",{className:"grid gap-y-8 gap-x-4 md:grid-cols-5 sm:grid-cols-4 xs:grid-cols-3 grid-cols-2 lg:grid-cols-6 mt-8",children:[h&&new Array(14).fill(0).map((l,s)=>e.jsx(B,{},s.toString()+"all")),a&&a.data.results.map((l,s)=>e.jsx(G,{data:l,mediaType:t},l.id+`${Math.random().toString()}`))]}),a&&e.jsx(L,{total:a.data.total_pages>500?1e4:a.data.total_results,pageSize:20,defaultCurrent:1,className:"mt-6 w-fully"})]})})})};export{W as default};
